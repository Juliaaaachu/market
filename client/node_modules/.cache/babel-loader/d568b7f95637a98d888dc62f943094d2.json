{"ast":null,"code":"'use strict';\n\nconst PromiseProvider = require('../promise_provider');\n\nconst emittedSymbol = Symbol.for('mongoose:emitted');\n\nmodule.exports = function promiseOrCallback(callback, fn, ee) {\n  if (typeof callback === 'function') {\n    return fn(function (error) {\n      if (error != null) {\n        if (ee != null && ee.listeners('error').length > 0 && !error[emittedSymbol]) {\n          error[emittedSymbol] = true;\n          ee.emit('error', error);\n        }\n\n        try {\n          callback(error);\n        } catch (error) {\n          return process.nextTick(() => {\n            throw error;\n          });\n        }\n\n        return;\n      }\n\n      callback.apply(this, arguments);\n    });\n  }\n\n  const Promise = PromiseProvider.get();\n  return new Promise((resolve, reject) => {\n    fn(function (error, res) {\n      if (error != null) {\n        if (ee != null && ee.listeners('error').length > 0 && !error[emittedSymbol]) {\n          error[emittedSymbol] = true;\n          ee.emit('error', error);\n        }\n\n        return reject(error);\n      }\n\n      if (arguments.length > 2) {\n        return resolve(Array.prototype.slice.call(arguments, 1));\n      }\n\n      resolve(res);\n    });\n  });\n};","map":{"version":3,"names":["PromiseProvider","require","emittedSymbol","Symbol","for","module","exports","promiseOrCallback","callback","fn","ee","error","listeners","length","emit","process","nextTick","apply","arguments","Promise","get","resolve","reject","res","Array","prototype","slice","call"],"sources":["/Users/juliachu/Dropbox/CS/market/node_modules/mongoose/lib/helpers/promiseOrCallback.js"],"sourcesContent":["'use strict';\n\nconst PromiseProvider = require('../promise_provider');\n\nconst emittedSymbol = Symbol.for('mongoose:emitted');\n\nmodule.exports = function promiseOrCallback(callback, fn, ee) {\n  if (typeof callback === 'function') {\n    return fn(function(error) {\n      if (error != null) {\n        if (ee != null && ee.listeners('error').length > 0 && !error[emittedSymbol]) {\n          error[emittedSymbol] = true;\n          ee.emit('error', error);\n        }\n        try {\n          callback(error);\n        } catch (error) {\n          return process.nextTick(() => {\n            throw error;\n          });\n        }\n        return;\n      }\n      callback.apply(this, arguments);\n    });\n  }\n\n  const Promise = PromiseProvider.get();\n\n  return new Promise((resolve, reject) => {\n    fn(function(error, res) {\n      if (error != null) {\n        if (ee != null && ee.listeners('error').length > 0 && !error[emittedSymbol]) {\n          error[emittedSymbol] = true;\n          ee.emit('error', error);\n        }\n        return reject(error);\n      }\n      if (arguments.length > 2) {\n        return resolve(Array.prototype.slice.call(arguments, 1));\n      }\n      resolve(res);\n    });\n  });\n};"],"mappings":"AAAA;;AAEA,MAAMA,eAAe,GAAGC,OAAO,CAAC,qBAAD,CAA/B;;AAEA,MAAMC,aAAa,GAAGC,MAAM,CAACC,GAAP,CAAW,kBAAX,CAAtB;;AAEAC,MAAM,CAACC,OAAP,GAAiB,SAASC,iBAAT,CAA2BC,QAA3B,EAAqCC,EAArC,EAAyCC,EAAzC,EAA6C;EAC5D,IAAI,OAAOF,QAAP,KAAoB,UAAxB,EAAoC;IAClC,OAAOC,EAAE,CAAC,UAASE,KAAT,EAAgB;MACxB,IAAIA,KAAK,IAAI,IAAb,EAAmB;QACjB,IAAID,EAAE,IAAI,IAAN,IAAcA,EAAE,CAACE,SAAH,CAAa,OAAb,EAAsBC,MAAtB,GAA+B,CAA7C,IAAkD,CAACF,KAAK,CAACT,aAAD,CAA5D,EAA6E;UAC3ES,KAAK,CAACT,aAAD,CAAL,GAAuB,IAAvB;UACAQ,EAAE,CAACI,IAAH,CAAQ,OAAR,EAAiBH,KAAjB;QACD;;QACD,IAAI;UACFH,QAAQ,CAACG,KAAD,CAAR;QACD,CAFD,CAEE,OAAOA,KAAP,EAAc;UACd,OAAOI,OAAO,CAACC,QAAR,CAAiB,MAAM;YAC5B,MAAML,KAAN;UACD,CAFM,CAAP;QAGD;;QACD;MACD;;MACDH,QAAQ,CAACS,KAAT,CAAe,IAAf,EAAqBC,SAArB;IACD,CAhBQ,CAAT;EAiBD;;EAED,MAAMC,OAAO,GAAGnB,eAAe,CAACoB,GAAhB,EAAhB;EAEA,OAAO,IAAID,OAAJ,CAAY,CAACE,OAAD,EAAUC,MAAV,KAAqB;IACtCb,EAAE,CAAC,UAASE,KAAT,EAAgBY,GAAhB,EAAqB;MACtB,IAAIZ,KAAK,IAAI,IAAb,EAAmB;QACjB,IAAID,EAAE,IAAI,IAAN,IAAcA,EAAE,CAACE,SAAH,CAAa,OAAb,EAAsBC,MAAtB,GAA+B,CAA7C,IAAkD,CAACF,KAAK,CAACT,aAAD,CAA5D,EAA6E;UAC3ES,KAAK,CAACT,aAAD,CAAL,GAAuB,IAAvB;UACAQ,EAAE,CAACI,IAAH,CAAQ,OAAR,EAAiBH,KAAjB;QACD;;QACD,OAAOW,MAAM,CAACX,KAAD,CAAb;MACD;;MACD,IAAIO,SAAS,CAACL,MAAV,GAAmB,CAAvB,EAA0B;QACxB,OAAOQ,OAAO,CAACG,KAAK,CAACC,SAAN,CAAgBC,KAAhB,CAAsBC,IAAtB,CAA2BT,SAA3B,EAAsC,CAAtC,CAAD,CAAd;MACD;;MACDG,OAAO,CAACE,GAAD,CAAP;IACD,CAZC,CAAF;EAaD,CAdM,CAAP;AAeD,CAtCD"},"metadata":{},"sourceType":"script"}